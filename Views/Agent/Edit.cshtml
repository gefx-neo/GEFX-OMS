@using DataAccess.POCO

@{
	Layout = "~/Views/Shared/_Layout.cshtml";
	ViewBag.Title = ViewData["SiteName"].ToString();
	ViewBag.PageTitle = "Edit Agent";
	ViewBag.ManageAgents = "active open";
}

<div class="panel">
	<div class="panel-body container-fluid">
		<div class="row row-lg">
			<div class="col-xlg-12 col-md-12">
				@if (TempData["Result"] != null)
				{
					string[] result = TempData["Result"].ToString().Split('|');

					<div class="alert alert-@result[0]">
						<button type="button" class="close" data-dismiss="alert">&times;</button>
						@result[1]
					</div>
				}

				@using (Html.BeginForm("Edit", "Agent", FormMethod.Post, new { @class = "form-horizontal", @id = "form-edit" }))
				{
					Agents agents = (Agents)ViewData["Agents"];

					<div class="form-group">
						@Html.LabelFor(u => agents.AgentId, new { @class = "col-sm-2 control-label" })
						<div class="col-sm-10">
							@Html.TextBoxFor(u => agents.AgentId, new { @class = "form-control", @placeholder = "Unique Agent ID" })
							@Html.ValidationMessageFor(u => agents.AgentId)
						</div>
					</div>
					<div class="form-group">
						@Html.LabelFor(u => agents.CompanyName, new { @class = "col-sm-2 control-label" })
						<div class="col-sm-10">
							@Html.TextBoxFor(u => agents.CompanyName, new { @class = "form-control" })
							@Html.ValidationMessageFor(u => agents.CompanyName)
						</div>
					</div>
					<div class="form-group">
						@Html.LabelFor(u => agents.ContactPerson, new { @class = "col-sm-2 control-label" })
						<div class="col-sm-10">
							@Html.TextBoxFor(u => agents.ContactPerson, new { @class = "form-control" })
							@Html.ValidationMessageFor(u => agents.ContactPerson)
						</div>
					</div>
					<div class="form-group">
						@Html.LabelFor(u => agents.ContactNumber, new { @class = "col-sm-2 control-label" })
						<div class="col-sm-10">
							@Html.TextBoxFor(u => agents.ContactNumber, new { @class = "form-control" })
							@Html.ValidationMessageFor(u => agents.ContactNumber)
						</div>
					</div>

					<div class="form-group">
						@Html.LabelFor(u => agents.Status, new { @class = "col-sm-2 control-label" })
						<div class="col-sm-10">
							@Html.DropDownListFor(u => agents.Status, (SelectList)ViewData["StatusDropdown"], new { @class = "form-control" })
							@Html.ValidationMessageFor(u => agents.Status)
						</div>
					</div>

					<div class="form-group">
						<div class="col-sm-10 col-sm-offset-2">
							<button type="submit" class="btn btn-primary" id="disable_button" onclick="disableButton()">Save</button>
							<a href="@Url.Action("Edit", new { @id = agents.ID })" class="btn btn-default btn-outline" id="disable_button2" onclick="disableButton2()">Reset</a>
							@{
								int page = 1;

								if (ViewData["Page"] != null)
								{
									page = Convert.ToInt32(ViewData["Page"]);
								}
							}
							<a href="@Url.Action("Listing", new { @page = page })" class="btn btn-danger" id="disable_button3" onclick="disableButton3()">Back</a>
						</div>
					</div>
				}
			</div>
		</div>
	</div>
</div>
<script>
	$(document).ready(function ()
	{
		var ViewOnly = "@ViewData["ViewOnly"].ToString()";
		if (ViewOnly == "Yes")
		{
			$( "#form-edit" ).prop( "disabled", true );
		}
    });

    function disableButton()
    {
        $("#disable_button").attr("disabled", true);
        $("#disable_button2").attr("disabled", true);
        $("#disable_button3").attr("disabled", true);

        $("#disable_button2").attr("href", "javascript:void(0)");
        $("#disable_button3").attr("href", "javascript:void(0)");
        $('#disable_button2').prop('onclick',null).off('click');
        $('#disable_button3').prop('onclick', null).off('click');

        $("#form-edit").submit();
    }

    function disableButton2()
    {
        $("#disable_button").attr("disabled", true);
        $("#disable_button2").attr("disabled", true);
        $("#disable_button3").attr("disabled", true);

        //javascript:void(0)
        $("#disable_button2").attr("href", "javascript:void(0)");
        $("#disable_button3").attr("href", "javascript:void(0)");
        $('#disable_button2').prop('onclick',null).off('click');
        $('#disable_button3').prop('onclick', null).off('click');

        window.location.href = '@Url.Action("Edit", new { @id = @ViewData["AgentID"].ToString() })'
    }

    function disableButton3()
    {
        $("#disable_button").attr("disabled", true);
        $("#disable_button2").attr("disabled", true);
        $("#disable_button3").attr("disabled", true);

        $("#disable_button2").attr("href", "javascript:void(0)");
        $("#disable_button3").attr("href", "javascript:void(0)");

        $('#disable_button2').prop('onclick',null).off('click');
        $('#disable_button3').prop('onclick',null).off('click');
        @{
             int page1 = 1;

             if (ViewData["Page"] != null)
             {
                  page1 = Convert.ToInt32(ViewData["Page"]);
             }
       }

        window.location.href = '@Url.Action("Listing", new { @page = page1 })';
    }
</script>